# Kylin-TARS GUI Agent å‡çº§ç‰ˆ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

Kylin-TARS å‡çº§ç‰ˆæ˜¯ä¸€ä¸ªåŸºäº openKylin æ¡Œé¢çš„å¤šæ™ºèƒ½ä½“ GUI æ“ä½œç³»ç»Ÿï¼Œé›†æˆäº† 4 ä¸ªä¸“ä¸šæ™ºèƒ½ä½“ï¼Œæä¾›ç»Ÿä¸€çš„ Web ç•Œé¢è¿›è¡Œä»»åŠ¡ç®¡ç†å’Œç³»ç»Ÿæ“ä½œã€‚

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### 1. å¤šæ™ºèƒ½ä½“æ¶æ„

- **FileAgent** - æ–‡ä»¶ç®¡ç†æ™ºèƒ½ä½“
  - æ–‡ä»¶æœç´¢ï¼ˆé€’å½’/éé€’å½’ï¼‰
  - ç§»åŠ¨åˆ°å›æ”¶ç«™
  - æ–‡ä»¶ä¿¡æ¯æŸ¥è¯¢

- **SettingsAgent** - ç³»ç»Ÿè®¾ç½®æ™ºèƒ½ä½“
  - æ¡Œé¢å£çº¸è®¾ç½®ï¼ˆ5ç§ç¼©æ”¾æ¨¡å¼ï¼‰
  - ç³»ç»ŸéŸ³é‡è°ƒæ•´
  - éŸ³é¢‘è®¾å¤‡ç®¡ç†

- **NetworkAgent** - ç½‘ç»œç®¡ç†æ™ºèƒ½ä½“
  - WiFi ç½‘ç»œæ‰«æ
  - WiFi è¿æ¥ç®¡ç†
  - ç³»ç»Ÿä»£ç†è®¾ç½®ï¼ˆHTTP/HTTPS/SOCKSï¼‰

- **AppAgent** - åº”ç”¨ç®¡ç†æ™ºèƒ½ä½“
  - åº”ç”¨æŸ¥æ‰¾å’Œå¯åŠ¨
  - åº”ç”¨å…³é—­ï¼ˆæ­£å¸¸/å¼ºåˆ¶ï¼‰
  - è¿è¡Œä¸­åº”ç”¨åˆ—è¡¨

### 2. å‡çº§ç‰ˆ Web UI

- **4æ¨¡å—å¸ƒå±€**
  - ğŸ¯ ä»»åŠ¡æ‰§è¡Œï¼šç»Ÿä¸€æŒ‡ä»¤è¾“å…¥ï¼Œè‡ªåŠ¨æ¨ç†é“¾è§£æ
  - ğŸ“ æ–‡ä»¶ç®¡ç†ï¼šæ–‡ä»¶æœç´¢å’Œæ“ä½œ
  - âš™ï¸ ç³»ç»Ÿè®¾ç½®ï¼šå£çº¸å’ŒéŸ³é‡ç®¡ç†
  - ğŸŒ ç½‘ç»œç®¡ç†ï¼šWiFi å’Œä»£ç†è®¾ç½®
  - ğŸ“± åº”ç”¨ç®¡ç†ï¼šåº”ç”¨å¯åŠ¨å’Œå…³é—­
  - ğŸ§  è®°å¿†è½¨è¿¹ï¼šå†å²ä»»åŠ¡æŸ¥è¯¢

- **äº¤äº’å¢å¼º**
  - å†å²æŒ‡ä»¤ä¸‹æ‹‰æ¡†ï¼ˆå¿«é€Ÿå¤ç”¨ï¼‰
  - æ¨ç†é“¾ JSON æ ¼å¼åŒ–å±•ç¤ºï¼ˆå…³é”®å­—æ®µé«˜äº®ï¼‰
  - å®æ—¶æ—¥å¿—æµ
  - æˆªå›¾è½®æ’­å±•ç¤º
  - ä¸€é”®å¤åˆ¶æ¨ç†é“¾

- **æ¼”ç¤ºæ¨¡å¼**
  - é¢„è®¾æ¼”ç¤ºä»»åŠ¡ï¼ˆæœç´¢+å£çº¸ã€ç½‘ç»œ+æµè§ˆå™¨ã€éŸ³é‡è°ƒæ•´ï¼‰
  - ä¸€é”®å¿«é€Ÿæµ‹è¯•

- **æƒé™æ§åˆ¶**
  - æ¼”ç¤ºæ¨¡å¼å¼€å…³ï¼ˆ`DEMO_MODE=true/false`ï¼‰
  - æ“ä½œç¡®è®¤æœºåˆ¶ï¼ˆ`REQUIRE_CONFIRMATION=true/false`ï¼‰

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
Kylin-TARS/
â”œâ”€â”€ Desktop/agent_project/src/
â”‚   â”œâ”€â”€ agent_template.py          # å­æ™ºèƒ½ä½“å¼€å‘æ¨¡æ¿
â”‚   â”œâ”€â”€ file_agent_logic.py         # FileAgent æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ file_agent_mcp.py          # FileAgent MCP æœåŠ¡
â”‚   â”œâ”€â”€ settings_agent_logic.py     # SettingsAgent æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ settings_agent_mcp.py       # SettingsAgent MCP æœåŠ¡
â”‚   â”œâ”€â”€ network_agent_logic.py     # NetworkAgent æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ network_agent_mcp.py        # NetworkAgent MCP æœåŠ¡
â”‚   â”œâ”€â”€ app_agent_logic.py          # AppAgent æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ app_agent_mcp.py           # AppAgent MCP æœåŠ¡
â”‚   â””â”€â”€ gradio_upgrade.py           # å‡çº§ç‰ˆ Gradio UI
â”œâ”€â”€ mcp_system/mcp_server/
â”‚   â””â”€â”€ mcp_server_fixed.py         # MCP Serverï¼ˆä¸»æ§ï¼‰
â”œâ”€â”€ start_upgrade.sh                # å‡çº§ç‰ˆå¯åŠ¨è„šæœ¬
â”œâ”€â”€ test_upgrade.sh                 # åŠŸèƒ½æµ‹è¯•è„šæœ¬
â””â”€â”€ README_UPGRADE.md              # æœ¬æ–‡æ¡£
```

## ğŸ› ï¸ å®‰è£…ä¸é…ç½®

### ç¯å¢ƒè¦æ±‚

- openKylin æ“ä½œç³»ç»Ÿ
- Python 3.10+
- Conda ç¯å¢ƒï¼š`uitars-vllm`
- ç³»ç»Ÿå·¥å…·ï¼š`scrot`, `wmctrl`, `xdotool`, `pactl`, `nmcli`

### ä¾èµ–å®‰è£…

```bash
# æ¿€æ´»ç¯å¢ƒ
conda activate uitars-vllm

# å®‰è£… Python ä¾èµ–
pip install gradio psutil dbus-python PyGObject

# å®‰è£…ç³»ç»Ÿå·¥å…·ï¼ˆå¦‚æœç¼ºå¤±ï¼‰
sudo apt-get install scrot wmctrl xdotool pulseaudio-utils network-manager
```

## ğŸ® ä½¿ç”¨æ–¹æ³•

### 1. å¯åŠ¨ç³»ç»Ÿ

```bash
cd /data1/cyx/Kylin-TARS
./start_upgrade.sh
```

å¯åŠ¨è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. å¯åŠ¨ MCP Serverï¼ˆä¸»æ§æœåŠ¡ï¼‰
2. å¯åŠ¨ 4 ä¸ªå­æ™ºèƒ½ä½“ï¼ˆFileAgent, SettingsAgent, NetworkAgent, AppAgentï¼‰
3. å¯åŠ¨ Gradio Web UIï¼ˆé»˜è®¤ç«¯å£ 7870ï¼‰

### 2. è®¿é—® Web UI

æµè§ˆå™¨æ‰“å¼€ï¼š`http://localhost:7870`

### 3. åŠŸèƒ½æµ‹è¯•

è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯æ‰€æœ‰åŠŸèƒ½ï¼š

```bash
./test_upgrade.sh
```

## ğŸ“– ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šæ–‡ä»¶æœç´¢ + å£çº¸è®¾ç½®

1. åœ¨ã€Œä»»åŠ¡æ‰§è¡Œã€é¡µé¢è¾“å…¥ï¼š
   ```
   æœç´¢ä¸‹è½½ç›®å½•çš„pngæ–‡ä»¶å¹¶è®¾ç½®ä¸ºå£çº¸
   ```

2. ç‚¹å‡»ã€Œâ–¶ï¸ æ‰§è¡Œä»»åŠ¡ã€

3. ç³»ç»Ÿä¼šè‡ªåŠ¨ï¼š
   - è°ƒç”¨ FileAgent æœç´¢ `~/Downloads` ç›®å½•ä¸‹çš„ PNG æ–‡ä»¶
   - è°ƒç”¨ SettingsAgent è®¾ç½®ç¬¬ä¸€ä¸ªæ‰¾åˆ°çš„ PNG ä¸ºå£çº¸
   - æ˜¾ç¤ºæ¨ç†é“¾å’Œæ‰§è¡Œç»“æœ

### ç¤ºä¾‹ 2ï¼šç½‘ç»œçŠ¶æ€ + å¯åŠ¨æµè§ˆå™¨

1. è¾“å…¥ï¼š
   ```
   è·å–å½“å‰ç½‘ç»œçŠ¶æ€ï¼Œç„¶åå¯åŠ¨Firefoxæµè§ˆå™¨
   ```

2. ç³»ç»Ÿä¼šï¼š
   - è°ƒç”¨ NetworkAgent è·å– WiFi å’Œä»£ç†çŠ¶æ€
   - è°ƒç”¨ AppAgent å¯åŠ¨ Firefox

### ç¤ºä¾‹ 3ï¼šéŸ³é‡è°ƒæ•´

1. è¾“å…¥ï¼š
   ```
   æŠŠç³»ç»ŸéŸ³é‡è°ƒåˆ°50%
   ```

2. ç³»ç»Ÿä¼šï¼š
   - è°ƒç”¨ SettingsAgent è°ƒæ•´éŸ³é‡åˆ° 50%

### ç¤ºä¾‹ 4ï¼šä½¿ç”¨æ¼”ç¤ºæ¨¡å¼

ç‚¹å‡»ã€ŒğŸ“ æœç´¢+å£çº¸ã€æŒ‰é’®ï¼Œè‡ªåŠ¨å¡«å……é¢„è®¾ä»»åŠ¡å¹¶æ‰§è¡Œã€‚

## ğŸ”§ é…ç½®é€‰é¡¹

### ç¯å¢ƒå˜é‡

åœ¨å¯åŠ¨è„šæœ¬æˆ–ç³»ç»Ÿç¯å¢ƒä¸­è®¾ç½®ï¼š

```bash
# æ¼”ç¤ºæ¨¡å¼å¼€å…³ï¼ˆé»˜è®¤ï¼štrueï¼‰
export DEMO_MODE=true

# æ“ä½œç¡®è®¤æœºåˆ¶ï¼ˆé»˜è®¤ï¼šfalseï¼‰
export REQUIRE_CONFIRMATION=false

# Gradio ç«¯å£ï¼ˆé»˜è®¤ï¼š7870ï¼‰
export GRADIO_SERVER_PORT=7870
```

### æƒé™æ§åˆ¶

å¦‚æœå¯ç”¨ `REQUIRE_CONFIRMATION=true`ï¼Œç”¨æˆ·åœ¨æ‰§è¡Œä»»åŠ¡å‰éœ€è¦å‹¾é€‰ã€Œâœ“ æˆ‘å·²ç¡®è®¤æ‰§è¡Œæ­¤æ“ä½œã€å¤é€‰æ¡†ã€‚

## ğŸ§ª å¼€å‘æŒ‡å—

### æ·»åŠ æ–°æ™ºèƒ½ä½“

1. **å¤åˆ¶æ¨¡æ¿**ï¼š
   ```bash
   cp Desktop/agent_project/src/agent_template.py Desktop/agent_project/src/new_agent_logic.py
   ```

2. **å®ç°æ ¸å¿ƒé€»è¾‘**ï¼š
   - ç»§æ‰¿ `BaseAgentLogic`
   - å®ç° `make_response()` æ–¹æ³•
   - æ·»åŠ å·¥å…·å‡½æ•°ï¼ˆå¦‚ `do_something()`ï¼‰

3. **åˆ›å»º MCP æœåŠ¡**ï¼š
   ```bash
   cp Desktop/agent_project/src/agent_template_mcp.py Desktop/agent_project/src/new_agent_mcp.py
   ```
   - å®šä¹‰å·¥å…·å…ƒæ•°æ® `NEW_AGENT_TOOLS`
   - å®ç° `handle_tool_call()` å‡½æ•°
   - æ³¨å†Œåˆ° MCP Server

4. **é›†æˆåˆ° Gradio UI**ï¼š
   - åœ¨ `gradio_upgrade.py` ä¸­æ·»åŠ æ–°æ ‡ç­¾é¡µ
   - ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°

5. **æ›´æ–°å¯åŠ¨è„šæœ¬**ï¼š
   - åœ¨ `start_upgrade.sh` ä¸­æ·»åŠ å¯åŠ¨å‘½ä»¤

## ğŸ“Š ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Gradio Web UI (å‰ç«¯)             â”‚
â”‚    gradio_upgrade.py                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         MCP Server (ä¸»æ§)               â”‚
â”‚    mcp_server_fixed.py                  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚      â”‚      â”‚      â”‚
       â–¼      â–¼      â–¼      â–¼
    File   Settings Network  App
   Agent   Agent    Agent   Agent
```

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šç«¯å£è¢«å ç”¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
- Gradio UI ä¼šè‡ªåŠ¨æŸ¥æ‰¾å¯ç”¨ç«¯å£ï¼ˆ7870-7879ï¼‰
- æˆ–æ‰‹åŠ¨è®¾ç½®ï¼š`export GRADIO_SERVER_PORT=8888`

### é—®é¢˜ 2ï¼šå­æ™ºèƒ½ä½“æœªå¯åŠ¨

**æ£€æŸ¥**ï¼š
```bash
# æ£€æŸ¥ MCP Server æ˜¯å¦è¿è¡Œ
dbus-send --session --print-reply \
  --dest=com.kylin.ai.mcp.MasterAgent \
  /com/kylin/ai/mcp/MasterAgent \
  com.kylin.ai.mcp.MasterAgent.ToolsList

# æ£€æŸ¥å­æ™ºèƒ½ä½“æ˜¯å¦æ³¨å†Œ
ps aux | grep agent_mcp.py
```

### é—®é¢˜ 3ï¼šæˆªå›¾åŠŸèƒ½ä¸å¯ç”¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# å®‰è£…æˆªå›¾å·¥å…·
sudo apt-get install scrot

# æˆ–ä½¿ç”¨ gnome-screenshot
sudo apt-get install gnome-screenshot
```

### é—®é¢˜ 4ï¼šç½‘ç»œåŠŸèƒ½ä¸å¯ç”¨

**æ£€æŸ¥**ï¼š
```bash
# æ£€æŸ¥ NetworkManager æœåŠ¡
systemctl status NetworkManager

# æ£€æŸ¥ nmcli å‘½ä»¤
which nmcli
```

## ğŸ“ æ›´æ–°æ—¥å¿—

### v2.0 (å‡çº§ç‰ˆ)

- âœ… æ–°å¢ NetworkAgentï¼ˆWiFi å’Œä»£ç†ç®¡ç†ï¼‰
- âœ… æ–°å¢ AppAgentï¼ˆåº”ç”¨å¯åŠ¨å’Œå…³é—­ï¼‰
- âœ… å‡çº§ Gradio UIï¼ˆ4æ¨¡å—å¸ƒå±€ + äº¤äº’å¢å¼ºï¼‰
- âœ… å®ç°æ¼”ç¤ºæ¨¡å¼å’Œæƒé™æ§åˆ¶
- âœ… æ·»åŠ å­æ™ºèƒ½ä½“å¼€å‘æ¨¡æ¿
- âœ… å®Œå–„é”™è¯¯å¤„ç†å’Œæ—¥å¿—ç³»ç»Ÿ

### v1.0 (åŸºç¡€ç‰ˆ)

- âœ… FileAgentï¼ˆæ–‡ä»¶æœç´¢ã€ç§»åŠ¨åˆ°å›æ”¶ç«™ï¼‰
- âœ… SettingsAgentï¼ˆå£çº¸è®¾ç½®ã€éŸ³é‡è°ƒæ•´ï¼‰
- âœ… åŸºç¡€ Gradio UI
- âœ… MCP åè®®é›†æˆ

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä¸ºå†…éƒ¨é¡¹ç›®ï¼Œä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚

## ğŸ‘¥ è´¡çŒ®è€…

- GUI Agent Team

## ğŸ“§ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»é¡¹ç›®ç»´æŠ¤å›¢é˜Ÿã€‚

---

**æœ€åæ›´æ–°**ï¼š2024-12

